<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Add review</title>
        <link rel="stylesheet" href="/css/genericStyles.css">
        <link rel="stylesheet" href="/css/panelForm.css">
        <!-- Quill CSS desde CDN -->
        <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet">
        <style>
            /* Fondo blanco para la barra de herramientas de Quill */
            .ql-toolbar.ql-snow {
                background: #ff4b4b;
            }
        </style>
    </head>
    <body>
        {{>header}}
        {{#Review}}
        <form action="/review/{{id}}/edit" method="POST" class="panel" enctype="multipart/form-data" onsubmit="return submitQuillForm();">
            <h2>Edit Review</h2>
            <div class="panel-group">
                <label for="quill-editor">Review</label>
                <div id="quill-editor" style="height: 300px;"></div>
                <input type="hidden" id="contenReview" name="contenReview" required>
            </div>
            <div class="panel-group">
                <input type="submit" class="boton_black" value="Edit">
            </div>
        </form>
        {{/Review}}        
        {{>footer}}
        <!-- Quill JS desde CDN -->
        <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
        <script>
            // Inicializar Quill sin el botón de link
            var quill = new Quill('#quill-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline', 'strike'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['clean']
                    ]
                }
            });

            var initialContent = '{{#Review}}{{{content}}}{{/Review}}';
            quill.root.innerHTML = initialContent;

            function submitQuillForm() {
                var html = quill.root.innerHTML.trim();
                // Evitar enviar solo un <p><br></p> vacío
                if (html === '<p><br></p>' || html === '') {
                    alert('Por favor, introduce una reseña.');
                    return false;
                }
                document.getElementById('contenReview').value = html;
                return true;
            }
        </script>
    </body>
</html>